seajs.use(["~slider@2","~box@1","~timer@1","~lazyload@1","~paging@1","~template@3","~login@1","~url@1","~cookie@1"],function(t,e,i,n,a,o,r,s,d){var l="hide",_="on",c=$("#sku_list_content"),u=1,m=!0,g=new e,f=0,p=!0,h={initUserInfo:function(){var t={},e="/main/get_login_msg.json";$.post(e,t,function(t){0==t.retcode?G_LOGIN=t.is_login:g.showError(t.retcode,t.retmsg)})},buildPageBar:function(t){var e=this,i={page:1,totalNum:1,totalPage:1,isAjax:!0,onClick:function(t){e.queryLimitedData(t,{scrolling:!0})}},n=new a($.extend(i,t));n.render("#pagebar")},scrollTopFun:function(t){$(window).scrollTop(t)},queryLimitedData:function(t){m=!1,u||(u=1),t&&(u=t);var e={event_id:G_EVENT_ID,plate_id:G_PLATE_ID,page:u},i="/main/get_list.json",n=this;$.post(i,e,function(t){var e=t.retcode,i=t.retmsg;if(m=!0,0==e){var a=t.limit_list;if(!$.isEmptyObject(a)){var r="tpl_sku_list",s="";if($.each(a,function(t,e){s+=o(r,{group:e})}),c.html(s),f){var d=$("#top_banner"),l=d.offset().top+d.height();n.scrollTopFun(l)}else f=1;n.bindLazyload("#sku_list_content"),p&&(p=!1,n.buildPageBar({totalNum:t.total_num,totalPage:t.total_page}))}}else g.showError(e,i)})},renderTopBanner:function(){new t({autoStart:"true",container:"#top_banner",bannerHeight:"440",interval:5e3})},bindLazyload:function(t){$(t).find("img").lazyload({effect:"fadeIn"}).trigger("scroll")},setListTimer:function(){var t=$(".js-hui-tag").parent();$.each(t,function(){var t=$(this),e=new i({showDay:!0,selector:t});e.start()})},remindBtn:function(t){if(!G_LOGIN)return void r.show({onSuccess:function(){window.location.href="/?plate_id="+G_PLATE_ID}});var e={sku_id:t.data("sku"),goods_id:t.data("goods-id"),goods_name:t.data("goods-name"),begin_time:t.data("begin-time"),amount:t.data("amount"),mart_amount:t.data("mart-amount"),plate_id:t.data("plate-id")},i="/main/send_remain_msg.json";FQL.Stat.clickStat("REMAIN_BTN_"+t.data("sku")),$.post(i,e,function(t){var e=t.retcode,i=t.retmsg;if(0==t.retcode){var n=t.result_rows,a=n.content;g.showMsg({retcode:a})}else g.showError(e,i)})},getUrlParams:function(){var t=this;if(s.get("plate_id")){G_PLATE_ID=s.get("plate_id");var e=$(".js-hui-tag");$.each(e,function(t,e){$(e).parent().data("plate-id")==G_PLATE_ID&&$(e).trigger("click")})}else t.queryLimitedData()},bindEvent:function(){var t=this;$("#sku_list_content").on("click",".js-remind-btn",function(e){e.preventDefault();var i=$(this);t.remindBtn(i)}),$("#sku_list_content").on("click",".js-sku",function(){FQL.Stat.clickStat($(this).data("fql-stat"))}),$(".js-hui-tag").on("click",function(){if(!m)return!1;p=!0,f=1,c.html(""),$("#pagebar").html("");var e=$(this).parent(),i=$(".js-hui-tag").parent(),n=i.filter("."+_),a=n.find(".js-time"),o=e.data("index");FQL.Stat.clickStat("PLAY_"+o),a.addClass(l),e.find(".js-time").removeClass(l),i.removeClass(_),e.addClass(_),u=1,G_PLATE_ID=e.data("plate-id"),t.queryLimitedData(),d.set("event_id",G_EVENT_ID+"_"+G_PLATE_ID+"_limit","fenqile.com","/",10080)})},sendSpeed:function(){seajs.use(["~speed@1"],function(t){new t({domainId:10,pageId:1,timePoint:G_SPEED_POINT_TIME})})},bindError:function(){var t=FQL.ErrorLogger.getLogger("index");t.bindError("911820000")},initParams:function(){G_SPEED_POINT_TIME.LOGIC={ID:5,DATA:[G_PAGE_LOAD_TIME,(new Date).getTime()]},d.set("event_id",G_EVENT_ID+"_"+G_PLATE_ID+"pc_limit","fenqile.com","/",10080)},init:function(){this.initUserInfo(),this.initParams(),this.renderTopBanner(),this.setListTimer(),this.bindEvent(),this.getUrlParams(),this.bindError(),this.sendSpeed()}};h.init()});
//# sourceMappingURL=//hui.fenqile.com/res/static/index.js.map